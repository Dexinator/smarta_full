---
// Header principal con navegaci칩n y controles de accesibilidad
// Audiogu칤as Murales Santa Marta

import { Image } from 'astro:assets';
import rutaMuralesLight from '../../assets/images/ruta-murales-light.jpg';
import rutaMuralesDark from '../../assets/images/ruta-murales-dark.png';
import turismoSantaMarta from '../../assets/images/turismo-santa-marta.png';

export interface Props {
  currentPage?: string;
  lang?: string;
}

const { currentPage = "", lang = "es" } = Astro.props;

// Contenido biling칲e
const content = {
  es: {
    home: "Inicio",
    audioguides: "Audiogu칤as",
    normative: "Audiogu칤a",
    descriptive: "Audiogu칤a Descriptiva",
    easy: "Audiogu칤a Lectura F치cil",
    sign: "Signogu칤a",
    map: "Mapa",
    download: "Descargar PDF",
    menu: "Men칰 Bot칩n",
    menuExpanded: "Men칰 Bot칩n Expandido",
    menuCollapsed: "Men칰 Bot칩n Contra칤do",
    lightMode: "Activar modo claro",
    darkMode: "Activar modo oscuro",
    highContrast: "Activar / desactivar Alto contraste",
    increaseFontSize: "Aumentar tama침o de texto",
    decreaseFontSize: "Disminuir tama침o de texto",
    language: "Cambiar idioma"
  },
  en: {
    home: "Home",
    audioguides: "Audio Guides",
    normative: "Spanish",
    descriptive: "Descriptive",
    easy: "Easy Read",
    sign: "Sign Guide",
    map: "Map",
    download: "Download PDF",
    menu: "Menu Button",
    menuExpanded: "Expanded Menu Button",
    menuCollapsed: "Collapsed Menu Button",
    lightMode: "Switch to light mode",
    darkMode: "Switch to dark mode",
    highContrast: "High contrast Button",
    increaseFontSize: "Increase text size",
    decreaseFontSize: "Decrease text size",
    language: "Change language"
  }
};

const t = content[lang as keyof typeof content];
---

<header class="bg-white dark:bg-slate-900 shadow-md border-b border-slate-200 dark:border-slate-700 sticky top-0 z-50">
  <nav class="container mx-auto px-4 py-4 md:py-5" role="navigation" aria-label="Navegaci칩n principal">
    <div class="flex justify-between items-center">

      <!-- Logos -->
      <div class="flex-shrink-0">
        <div class="flex items-center space-x-2 md:space-x-3">
          <!-- Logo Ruta de los Murales (principal) - cambia seg칰n tema -->
          <a href="/" class="focus-visible">
            <Image
              src={rutaMuralesLight}
              alt="Logotipo Ruta de los Murales Santa Marta de Tormes ir a p치gina principal"
              class="h-14 sm:h-16 md:h-20 w-auto object-contain dark:hidden"
              loading="eager"
              quality={90}
            />
            <Image
              src={rutaMuralesDark}
              alt="Logotipo Ruta de los Murales Santa Marta de Tormes ir a p치gina principal"
              class="h-14 sm:h-16 md:h-20 w-auto object-contain hidden dark:block"
              loading="eager"
              quality={90}
            />
          </a>
          <!-- Logo Turismo Santa Marta -->
          <a href="https://www.turismosantamartadetormes.com/" target="_blank" rel="noopener noreferrer" class="focus-visible">
            <Image
              src={turismoSantaMarta}
              alt="Logotipo Turismo Santa Marta de Tormes ir a p치gina Turismo Santa Marta de Tormes"
              class="h-12 sm:h-14 md:h-16 w-auto object-contain"
              loading="eager"
              quality={90}
            />
          </a>
        </div>
      </div>

      <!-- Navegaci칩n Desktop -->
      <div class="hidden lg:flex items-center space-x-6">
        <a
          href="/"
          class={`text-base md:text-lg font-medium transition-colors hover:text-SM-blue focus-visible ${
            currentPage === "home" ? "text-SM-blue" : "text-slate-600 dark:text-slate-300"
          }`}
        >
          {t.home}
        </a>

        <div class="relative group">
          <button class="text-base md:text-lg font-medium text-slate-600 dark:text-slate-300 hover:text-SM-blue transition-colors focus-visible flex items-center">
            {t.audioguides}
            <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path d="M5.70711 9.71069C5.31658 10.1012 5.31658 10.7344 5.70711 11.1249L10.5993 16.0123C11.3805 16.7927 12.6463 16.7924 13.4271 16.0117L18.3174 11.1213C18.708 10.7308 18.708 10.0976 18.3174 9.70708C17.9269 9.31655 17.2937 9.31655 16.9032 9.70708L12.7176 13.8927C12.3271 14.2833 11.6939 14.2832 11.3034 13.8927L7.12132 9.71069C6.7308 9.32016 6.09763 9.32016 5.70711 9.71069Z" fill="#0F0F0F"/>
              </svg>
          </button>

          <!-- Dropdown menu -->
          <div class="absolute top-full left-0 mt-1 w-48 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-slate-200 dark:border-slate-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
            <div class="py-2">
              <a href="/audioguia-normativa" class="block px-4 py-3 text-base text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 hover:text-SM-blue transition-colors">
                {t.normative}
              </a>
              <a href="/audioguia-descriptiva" class="block px-4 py-3 text-base text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 hover:text-SM-blue transition-colors">
                {t.descriptive}
              </a>
              <a href="/audioguia-facil" class="block px-4 py-3 text-base text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 hover:text-SM-blue transition-colors">
                {t.easy}
              </a>
              <a href="/signoguia" class="block px-4 py-3 text-base text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 hover:text-SM-blue transition-colors">
                {t.sign}
              </a>
            </div>
          </div>
        </div>
      </div>


        <!-- Men칰 hamburguesa m칩vil -->
        <button
          id="mobile-menu-button"
          class="lg:hidden p-3 rounded-lg bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 focus-visible"
          aria-label={t.menu}
          aria-expanded="false"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Men칰 m칩vil -->
    <div id="mobile-menu" class="lg:hidden hidden mt-4 pb-4 border-t border-slate-200 dark:border-slate-700">
      <div class="pt-4 space-y-2">
        <a
          href={lang === "es" ? "/" : "/english"}
          class="block px-3 py-3 text-lg font-medium text-slate-600 dark:text-slate-300 hover:text-SM-blue hover:bg-slate-50 dark:hover:bg-slate-800 rounded-lg transition-colors"
        >
          {t.home}
        </a>

        <div class="px-3 py-2">
          <div class="text-base font-medium text-slate-400 dark:text-slate-500 mb-2">{t.audioguides}</div>
          <div class="space-y-1 ml-4">
            <a href="/audioguia-normativa" class="block py-2 text-base text-slate-600 dark:text-slate-300 hover:text-SM-blue transition-colors">
              {t.normative}
            </a>
            <a href="/audioguia-descriptiva" class="block py-2 text-base text-slate-600 dark:text-slate-300 hover:text-SM-blue transition-colors">
              {t.descriptive}
            </a>
            <a href="/audioguia-facil" class="block py-2 text-base text-slate-600 dark:text-slate-300 hover:text-SM-blue transition-colors">
              {t.easy}
            </a>
            <a href="/signoguia" class="block py-2 text-base text-slate-600 dark:text-slate-300 hover:text-SM-blue transition-colors">
              {t.sign}
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Controles de accesibilidad m칩vil (siempre visibles) -->
    <div class="border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 py-3">
      <div class="px-4">
        <div class="flex items-center justify-between w-full space-x-1">
          <!-- Selector de idioma -->
          <a
            href={lang === "es" ? "/english" : "/"}
            class="flex-1 px-2 py-2 rounded-lg bg-white dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 focus-visible text-sm font-medium shadow-sm text-center h-10 flex items-center justify-center"
            aria-label={t.language}
          >
            <span class="text-base leading-none">{lang === "es" ? "EN" : "ES"}</span>
          </a>

          <!-- Modo claro -->
          <button
            onclick="setLightMode()"
            class="flex-1 px-2 py-2 rounded-lg bg-white dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 focus-visible shadow-sm h-10 flex items-center justify-center"
            aria-label={t.lightMode}
          >
            <span class="text-base leading-none">游댅</span>
          </button>

          <!-- Modo oscuro -->
          <button
            onclick="setDarkMode()"
            class="flex-1 px-2 py-2 rounded-lg bg-white dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 focus-visible shadow-sm h-10 flex items-center justify-center"
            aria-label={t.darkMode}
          >
            <span class="text-base leading-none">游깿</span>
          </button>

          <!-- Alto contraste -->
          <button
            onclick="toggleHighContrast()"
            class="flex-1 px-2 py-2 rounded-lg bg-white dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 focus-visible shadow-sm h-10 flex items-center justify-center"
            aria-label={t.highContrast}
          >
            <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 508.47" class="w-4 h-4 fill-current">
              <path fill-rule="nonzero" d="M254.23 508.47c-3.94 0-7.87-.1-11.77-.28h-1.54v-.07c-64.9-3.34-123.37-31.04-166.45-74.12C28.46 387.99 0 324.42 0 254.23c0-70.19 28.46-133.75 74.47-179.76C117.55 31.39 176.03 3.69 240.92.34V.27h1.54c3.9-.18 7.83-.27 11.77-.27l3.46.02.08-.02c70.19 0 133.75 28.46 179.76 74.47 46 46.01 74.47 109.57 74.47 179.76S483.53 387.99 437.53 434c-46.01 46.01-109.57 74.47-179.76 74.47l-.08-.03-3.46.03zm-13.31-30.56V30.56C184.33 33.87 133.4 58.17 95.79 95.79c-40.55 40.54-65.62 96.56-65.62 158.44 0 61.89 25.07 117.91 65.62 158.45 37.61 37.61 88.54 91.91 145.13 65.23z"/>
            </svg>
          </button>

          <!-- Tama침o de fuente -->
          <button
            onclick="adjustFontSize(1)"
            class="flex-1 px-2 py-2 rounded-lg bg-white dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 focus-visible text-sm font-bold shadow-sm h-10 flex items-center justify-center"
            aria-label={t.increaseFontSize}
          >
            <span class="text-base leading-none">A+</span>
          </button>

          <button
            onclick="adjustFontSize(-1)"
            class="flex-1 px-2 py-2 rounded-lg bg-white dark:bg-slate-700 hover:bg-slate-100 dark:hover:bg-slate-600 focus-visible text-sm font-bold shadow-sm h-10 flex items-center justify-center"
            aria-label={t.decreaseFontSize}
          >
            <span class="text-base leading-none">A-</span>
          </button>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  // Script para el men칰 m칩vil
  document.addEventListener('DOMContentLoaded', () => {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');

    if (mobileMenuButton && mobileMenu) {
      mobileMenuButton.addEventListener('click', () => {
        const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';

        mobileMenuButton.setAttribute('aria-expanded', (!isExpanded).toString());
        mobileMenu.classList.toggle('hidden');
      });
    }
  });
</script>